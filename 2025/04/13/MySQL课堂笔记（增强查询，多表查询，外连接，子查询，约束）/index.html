<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="true" > 
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  

  
  <title>MySQL课堂笔记（增强查询，多表查询，外连接，子查询，约束） | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="MySQLMySQL表查询在实际开发的过程中，我们需要用到的查询不只有前面的简单查询，我们还需要学习一些更为符合实际的查询方式，如日期查询，多表查询等 相关表格我们先来建立几个表格，填入响应数据 员工表emp12345678910CREATE TABLE emp (	&#96;empno&#96; INT,	&#96;ename&#96; VARCHAR ( 30 ),	&#96;job&#96; VARCHAR ( 20 ),	&#96;mgr&#96; I">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL课堂笔记（增强查询，多表查询，外连接，子查询，约束）">
<meta property="og:url" content="http://example.com/2025/04/13/MySQL%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0%EF%BC%88%E5%A2%9E%E5%BC%BA%E6%9F%A5%E8%AF%A2%EF%BC%8C%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2%EF%BC%8C%E5%A4%96%E8%BF%9E%E6%8E%A5%EF%BC%8C%E5%AD%90%E6%9F%A5%E8%AF%A2%EF%BC%8C%E7%BA%A6%E6%9D%9F%EF%BC%89/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="MySQLMySQL表查询在实际开发的过程中，我们需要用到的查询不只有前面的简单查询，我们还需要学习一些更为符合实际的查询方式，如日期查询，多表查询等 相关表格我们先来建立几个表格，填入响应数据 员工表emp12345678910CREATE TABLE emp (	&#96;empno&#96; INT,	&#96;ename&#96; VARCHAR ( 30 ),	&#96;job&#96; VARCHAR ( 20 ),	&#96;mgr&#96; I">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-04-13T06:45:00.000Z">
<meta property="article:modified_time" content="2025-04-13T13:40:51.015Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-192.png" sizes="192x192">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-192.png" sizes="192x192">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/1.jpg" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="  ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>Hexo </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
      <a id="nav-rss-link" class="nav-icon mobile-hide" href="/atom.xml" title="RSS Feed">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M198-120q-25.846 0-44.23-18.384-18.384-18.385-18.384-44.23 0-25.846 18.384-44.23 18.384-18.385 44.23-18.385 25.846 0 44.23 18.385 18.384 18.384 18.384 44.23 0 25.845-18.384 44.23Q223.846-120 198-120Zm538.385 0q-18.846 0-32.923-13.769-14.076-13.769-15.922-33.23-8.692-100.616-51.077-188.654-42.385-88.039-109.885-155.539-67.5-67.501-155.539-109.885Q283-663.462 182.385-672.154q-19.461-1.846-33.23-16.23-13.769-14.385-13.769-33.846t14.076-32.922q14.077-13.461 32.923-12.23 120.076 8.692 226.038 58.768 105.961 50.077 185.73 129.846 79.769 79.769 129.846 185.731 50.077 105.961 58.769 226.038 1.231 18.846-12.538 32.922Q756.461-120 736.385-120Zm-252 0q-18.231 0-32.423-13.461t-18.653-33.538Q418.155-264.23 348.886-333.5q-69.27-69.27-166.501-84.423-20.077-4.462-33.538-18.961-13.461-14.5-13.461-33.346 0-19.076 13.884-33.23 13.884-14.153 33.115-10.922 136.769 15.384 234.384 112.999 97.615 97.615 112.999 234.384 3.231 19.23-10.538 33.115Q505.461-120 484.385-120Z"/></svg>
      </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/archives">Archives</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
    
      <a class="nav-dropdown-link" href="/atom.xml" title="RSS Feed">RSS</a>
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/2.jpg></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Thrinisty </div>
      <div class="dot"></div>
      <div class="subtitle">苦逼大学生来的 </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://twitter.com" title="Twitter"><i class="fa-brands fa-twitter"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://store.steampowered.com" title="Steam"><i class="fa-brands fa-steam"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com" title="GitHub"><i class="fa-brands fa-github"></i></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      



    
      

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       


<article id="post-MySQL课堂笔记（增强查询，多表查询，外连接，子查询，约束）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        MySQL课堂笔记（增强查询，多表查询，外连接，子查询，约束）
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2025-04-13T06:45:00.000Z" itemprop="datePublished">2025-04-13</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
    Uncategorized 
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            20k words 
          </div>
        </div>
        
      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h1 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h1><h2 id="MySQL表查询"><a href="#MySQL表查询" class="headerlink" title="MySQL表查询"></a>MySQL表查询</h2><p>在实际开发的过程中，我们需要用到的查询不只有前面的简单查询，我们还需要学习一些更为符合实际的查询方式，如日期查询，多表查询等</p>
<h3 id="相关表格"><a href="#相关表格" class="headerlink" title="相关表格"></a>相关表格</h3><p>我们先来建立几个表格，填入响应数据</p>
<h4 id="员工表emp"><a href="#员工表emp" class="headerlink" title="员工表emp"></a>员工表emp</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp (</span><br><span class="line">	`empno` <span class="type">INT</span>,</span><br><span class="line">	`ename` <span class="type">VARCHAR</span> ( <span class="number">30</span> ),</span><br><span class="line">	`job` <span class="type">VARCHAR</span> ( <span class="number">20</span> ),</span><br><span class="line">	`mgr` <span class="type">INT</span>,</span><br><span class="line">	`hiredate` <span class="type">DATE</span>,</span><br><span class="line">	`sal` <span class="keyword">DOUBLE</span>,</span><br><span class="line">	`comm` <span class="keyword">DOUBLE</span>,</span><br><span class="line">`deptno` <span class="type">INT</span> </span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">	( <span class="number">7396</span>, <span class="string">&#x27;SMITH&#x27;</span>, <span class="string">&#x27;CLERK&#x27;</span>, <span class="number">7902</span>, <span class="string">&#x27;1990-12-17&#x27;</span>, <span class="number">800.00</span>, <span class="keyword">NULL</span>, <span class="number">20</span> ),</span><br><span class="line">	( <span class="number">7499</span>, <span class="string">&#x27;ALLEN&#x27;</span>, <span class="string">&#x27;SALESMAN&#x27;</span>, <span class="number">7902</span>, <span class="string">&#x27;1991-02-20&#x27;</span>, <span class="number">1600.00</span>, <span class="number">300.00</span>, <span class="number">30</span> ),</span><br><span class="line">	( <span class="number">7596</span>, <span class="string">&#x27;WARD&#x27;</span>, <span class="string">&#x27;SALESMAN&#x27;</span>, <span class="number">7896</span>, <span class="string">&#x27;1993-02-07&#x27;</span>, <span class="number">1250.00</span>, <span class="number">500.00</span>, <span class="number">30</span> ),</span><br><span class="line">	( <span class="number">7696</span>, <span class="string">&#x27;JOOES&#x27;</span>, <span class="string">&#x27;MANAGER&#x27;</span>, <span class="number">7839</span>, <span class="string">&#x27;1980-02-01&#x27;</span>, <span class="number">2975.00</span>, <span class="keyword">NULL</span>, <span class="number">20</span> ),</span><br><span class="line">	( <span class="number">7796</span>, <span class="string">&#x27;MARTIN&#x27;</span>, <span class="string">&#x27;SALESMAN&#x27;</span>, <span class="number">7698</span>, <span class="string">&#x27;1999-04-17&#x27;</span>, <span class="number">1250.00</span>, <span class="number">1400.00</span>, <span class="number">30</span> ),</span><br><span class="line">	( <span class="number">7896</span>, <span class="string">&#x27;BLAKE&#x27;</span>, <span class="string">&#x27;MANAGER&#x27;</span>, <span class="number">7839</span>, <span class="string">&#x27;1990-12-17&#x27;</span>, <span class="number">2850.00</span>, <span class="keyword">NULL</span>, <span class="number">30</span> );</span><br></pre></td></tr></table></figure>



<h4 id="工作部门表dept"><a href="#工作部门表dept" class="headerlink" title="工作部门表dept"></a>工作部门表dept</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> dept ( </span><br><span class="line">`deptno` <span class="type">INT</span>, </span><br><span class="line">`dname` <span class="type">VARCHAR</span> ( <span class="number">30</span> ), </span><br><span class="line">`loc` <span class="type">VARCHAR</span> ( <span class="number">30</span> ) </span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dept</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">	( <span class="number">10</span>, <span class="string">&#x27;ACCOUNTING&#x27;</span>, <span class="string">&#x27;NEW YORK&#x27;</span> ),</span><br><span class="line">	( <span class="number">20</span>, <span class="string">&#x27;RESEARCH&#x27;</span>, <span class="string">&#x27;DALLAS&#x27;</span> ),</span><br><span class="line">	( <span class="number">30</span>, <span class="string">&#x27;SALES&#x27;</span>, <span class="string">&#x27;CHICAGO&#x27;</span> ),</span><br><span class="line">	( <span class="number">40</span>, <span class="string">&#x27;OPERATIONS&#x27;</span>, <span class="string">&#x27;BOSTON&#x27;</span> );</span><br></pre></td></tr></table></figure>



<h4 id="薪水表格salgrade"><a href="#薪水表格salgrade" class="headerlink" title="薪水表格salgrade"></a>薪水表格salgrade</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> salgrade ( </span><br><span class="line">    `grade` <span class="type">INT</span>, </span><br><span class="line">    `losal` <span class="keyword">DOUBLE</span>, </span><br><span class="line">    `hisal` <span class="keyword">DOUBLE</span> </span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> salgrade</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">	( <span class="number">1</span>, <span class="number">700.00</span>, <span class="number">1200.00</span> ),</span><br><span class="line">	( <span class="number">2</span>, <span class="number">1200.00</span>, <span class="number">1400.00</span> ),</span><br><span class="line">	( <span class="number">3</span>, <span class="number">1400.00</span>, <span class="number">3000.00</span> ),</span><br><span class="line">	( <span class="number">4</span>, <span class="number">3000.00</span>, <span class="number">9000.00</span> );</span><br></pre></td></tr></table></figure>



<h3 id="查询加强"><a href="#查询加强" class="headerlink" title="查询加强"></a>查询加强</h3><h4 id="where筛选日期"><a href="#where筛选日期" class="headerlink" title="where筛选日期"></a>where筛选日期</h4><p>查找1992.1.1后入职的员工</p>
<p>需要至于格式01-01</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,hiredate <span class="keyword">from</span> emp <span class="keyword">where</span> hiredate <span class="operator">&gt;</span> <span class="string">&#x27;1992-01-01&#x27;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+--------+------------+</span><br><span class="line">| ename  | hiredate   |</span><br><span class="line">+--------+------------+</span><br><span class="line">| WARD   | <span class="number">1993</span>-<span class="number">02</span>-<span class="number">07</span> |</span><br><span class="line">| MARTIN | <span class="number">1999</span>-<span class="number">04</span>-<span class="number">17</span> |</span><br><span class="line">+--------+------------+</span><br></pre></td></tr></table></figure>



<h4 id="like模糊查询"><a href="#like模糊查询" class="headerlink" title="like模糊查询"></a>like模糊查询</h4><p>​	%：表示0到多个任意字符</p>
<p>​	_ ：表示单个任意字符</p>
<p>如何显示首字符为s的员工共姓名和工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,sal <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> <span class="string">&#x27;s%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+-------+-----+</span><br><span class="line">| ename | sal |</span><br><span class="line">+-------+-----+</span><br><span class="line">| SMITH | <span class="number">800</span> |</span><br><span class="line">+-------+-----+</span><br></pre></td></tr></table></figure>



<p>如何显示第三个字符为大写o的所有员工姓名和工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,sal <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> <span class="string">&#x27;__o%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+-------+------+</span><br><span class="line">| ename | sal  |</span><br><span class="line">+-------+------+</span><br><span class="line">| JOOES | <span class="number">2975</span> |</span><br><span class="line">+-------+------+</span><br></pre></td></tr></table></figure>



<h4 id="order-by排序"><a href="#order-by排序" class="headerlink" title="order by排序"></a>order by排序</h4><p>从工资低到高显示员工</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+-------+--------+----------+------+------------+------+------+--------+</span><br><span class="line">| empno | ename  | job      | mgr  | hiredate   | sal  | comm | deptno |</span><br><span class="line">+-------+--------+----------+------+------------+------+------+--------+</span><br><span class="line">|  <span class="number">7396</span> | SMITH  | CLERK    | <span class="number">7902</span> | <span class="number">1990</span>-<span class="number">12</span>-<span class="number">17</span> |  <span class="number">800</span> | NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7596</span> | WARD   | SALESMAN | <span class="number">7902</span> | <span class="number">1993</span>-<span class="number">02</span>-<span class="number">07</span> | <span class="number">1250</span> |  <span class="number">500</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7796</span> | MARTIN | SALESMAN | <span class="number">7698</span> | <span class="number">1999</span>-<span class="number">04</span>-<span class="number">17</span> | <span class="number">1250</span> | <span class="number">1400</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN | <span class="number">7902</span> | <span class="number">1991</span>-<span class="number">02</span>-<span class="number">20</span> | <span class="number">1600</span> |  <span class="number">300</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7896</span> | BLAKE  | MANAGER  | <span class="number">7839</span> | <span class="number">1990</span>-<span class="number">12</span>-<span class="number">17</span> | <span class="number">2850</span> | NULL |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7696</span> | JOOES  | MANAGER  | <span class="number">7839</span> | <span class="number">1980</span>-<span class="number">02</span>-<span class="number">01</span> | <span class="number">2975</span> | NULL |     <span class="number">20</span> |</span><br><span class="line">+-------+--------+----------+------+------------+------+------+--------+</span><br></pre></td></tr></table></figure>

<p>按照部门编号升序，员工工资降序排序（中间用，隔开）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> deptno <span class="keyword">asc</span> , sal <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+-------+--------+----------+------+------------+------+------+--------+</span><br><span class="line">| empno | ename  | job      | mgr  | hiredate   | sal  | comm | deptno |</span><br><span class="line">+-------+--------+----------+------+------------+------+------+--------+</span><br><span class="line">|  <span class="number">7696</span> | JOOES  | MANAGER  | <span class="number">7839</span> | <span class="number">1980</span>-<span class="number">02</span>-<span class="number">01</span> | <span class="number">2975</span> | NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7396</span> | SMITH  | CLERK    | <span class="number">7902</span> | <span class="number">1990</span>-<span class="number">12</span>-<span class="number">17</span> |  <span class="number">800</span> | NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7896</span> | BLAKE  | MANAGER  | <span class="number">7839</span> | <span class="number">1990</span>-<span class="number">12</span>-<span class="number">17</span> | <span class="number">2850</span> | NULL |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN | <span class="number">7902</span> | <span class="number">1991</span>-<span class="number">02</span>-<span class="number">20</span> | <span class="number">1600</span> |  <span class="number">300</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7596</span> | WARD   | SALESMAN | <span class="number">7902</span> | <span class="number">1993</span>-<span class="number">02</span>-<span class="number">07</span> | <span class="number">1250</span> |  <span class="number">500</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7796</span> | MARTIN | SALESMAN | <span class="number">7698</span> | <span class="number">1999</span>-<span class="number">04</span>-<span class="number">17</span> | <span class="number">1250</span> | <span class="number">1400</span> |     <span class="number">30</span> |</span><br><span class="line">+-------+--------+----------+------+------------+------+------+--------+</span><br></pre></td></tr></table></figure>



<h4 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h4><p>在实际开发中我们数据量往往很大，我们会用到分页来进行查询，这里介绍一个关键字limit</p>
<p>基本语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ... limit <span class="keyword">start</span>, <span class="keyword">rows</span></span><br></pre></td></tr></table></figure>

<p>表示从start + 1 行开始取，取出rows行，例如上述的例子中，我们需要取出前5行结果使用如下的语句即可，从第1行开始取5行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> deptno <span class="keyword">asc</span> , sal <span class="keyword">desc</span> limit <span class="number">0</span>, <span class="number">5</span>;</span><br></pre></td></tr></table></figure>



<p>我们是实际中使用我们就可以运用limit限制每一次查询的范围</p>
<p>要将一个大表范围若干个小表可以这么做</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> deptno <span class="keyword">asc</span> , sal <span class="keyword">desc</span> limit <span class="number">0</span>, <span class="number">4</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> deptno <span class="keyword">asc</span> , sal <span class="keyword">desc</span> limit <span class="number">4</span>, <span class="number">4</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> deptno <span class="keyword">asc</span> , sal <span class="keyword">desc</span> limit <span class="number">8</span>, <span class="number">4</span>;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>



<h4 id="group-by分组"><a href="#group-by分组" class="headerlink" title="group by分组"></a>group by分组</h4><p>我们有如下的几个题目</p>
<p>1.显示每种岗位的雇员总数，平均工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>), <span class="built_in">avg</span>(sal), job <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> job;</span><br></pre></td></tr></table></figure>



<p>2.显示雇员的总数，以及获得补助的雇员数</p>
<p>这里输入comm，comm字段为空则不参与统计</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>), <span class="built_in">count</span>(comm) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p>如果我们扩展一下</p>
<p>没有获得补助的员工</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>), <span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">-</span><span class="built_in">count</span>(comm) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>), <span class="built_in">count</span>(if(comm <span class="keyword">is</span> <span class="keyword">null</span>, <span class="number">1</span>, <span class="keyword">null</span>)) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>



<p>3.显示管理者的总人数</p>
<p>先count再去重</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> mgr) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p>4.显示雇员工资的最大差值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(sal)<span class="operator">-</span><span class="built_in">min</span>(sal) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>



<h4 id="多子句查询"><a href="#多子句查询" class="headerlink" title="多子句查询"></a>多子句查询</h4><p>顺序：如果一个select语句同时包含了group by，having，limit，order by，那么它们的顺序应该为：group by，having，order by，limit</p>
<p>例如统计各个部门的平均工资，并且是大于1000的，按照平均工资从高到低排序，取出前两行记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(sal),deptno <span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno </span><br><span class="line"><span class="keyword">having</span> <span class="built_in">avg</span>(sal)<span class="operator">&gt;</span><span class="number">1000</span> </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="built_in">avg</span>(sal) <span class="keyword">desc</span> </span><br><span class="line">limit <span class="number">0</span>, <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>其实更建议使用as重命名，可以增快速度</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(sal) <span class="keyword">as</span> asql, deptno <span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno </span><br><span class="line"><span class="keyword">having</span> asql<span class="operator">&gt;</span><span class="number">1000</span> </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> asql <span class="keyword">desc</span> </span><br><span class="line">limit <span class="number">0</span>, <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+----------+--------+</span><br><span class="line">| avg(sal) | deptno |</span><br><span class="line">+----------+--------+</span><br><span class="line">|   <span class="number">1887</span>.<span class="number">5</span> |     <span class="number">20</span> |</span><br><span class="line">|   <span class="number">1737</span>.<span class="number">5</span> |     <span class="number">30</span> |</span><br><span class="line">+----------+--------+</span><br></pre></td></tr></table></figure>



<h3 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h3><p>多表查询是指基于两个和两个以上的表的查询，在实际的应用中，查询单个表可能不能满足需求</p>
<p>例如说显示雇员名，雇员工资，所在部门的名字，就需要员工表和工作部门表</p>
<h4 id="多表笛卡尔集"><a href="#多表笛卡尔集" class="headerlink" title="多表笛卡尔集"></a>多表笛卡尔集</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp, dept;</span><br></pre></td></tr></table></figure>

<p>可见笛卡尔集需要将两种表做笛卡尔积（在不加条件的结果非常夸张）</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">+-------+--------+----------+------+------------+------+------+--------+--------+------------+----------+</span><br><span class="line">| empno | ename  | job      | mgr  | hiredate   | sal  | comm | deptno | deptno | dname      | loc      |</span><br><span class="line">+-------+--------+----------+------+------------+------+------+--------+--------+------------+----------+</span><br><span class="line">|  <span class="number">7396</span> | SMITH  | CLERK    | <span class="number">7902</span> | <span class="number">1990</span>-<span class="number">12</span>-<span class="number">17</span> |  <span class="number">800</span> | NULL |     <span class="number">20</span> |     <span class="number">40</span> | OPERATIONS | BOSTON   |</span><br><span class="line">|  <span class="number">7396</span> | SMITH  | CLERK    | <span class="number">7902</span> | <span class="number">1990</span>-<span class="number">12</span>-<span class="number">17</span> |  <span class="number">800</span> | NULL |     <span class="number">20</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7396</span> | SMITH  | CLERK    | <span class="number">7902</span> | <span class="number">1990</span>-<span class="number">12</span>-<span class="number">17</span> |  <span class="number">800</span> | NULL |     <span class="number">20</span> |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7396</span> | SMITH  | CLERK    | <span class="number">7902</span> | <span class="number">1990</span>-<span class="number">12</span>-<span class="number">17</span> |  <span class="number">800</span> | NULL |     <span class="number">20</span> |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN | <span class="number">7902</span> | <span class="number">1991</span>-<span class="number">02</span>-<span class="number">20</span> | <span class="number">1600</span> |  <span class="number">300</span> |     <span class="number">30</span> |     <span class="number">40</span> | OPERATIONS | BOSTON   |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN | <span class="number">7902</span> | <span class="number">1991</span>-<span class="number">02</span>-<span class="number">20</span> | <span class="number">1600</span> |  <span class="number">300</span> |     <span class="number">30</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN | <span class="number">7902</span> | <span class="number">1991</span>-<span class="number">02</span>-<span class="number">20</span> | <span class="number">1600</span> |  <span class="number">300</span> |     <span class="number">30</span> |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN | <span class="number">7902</span> | <span class="number">1991</span>-<span class="number">02</span>-<span class="number">20</span> | <span class="number">1600</span> |  <span class="number">300</span> |     <span class="number">30</span> |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  <span class="number">7596</span> | WARD   | SALESMAN | <span class="number">7902</span> | <span class="number">1993</span>-<span class="number">02</span>-<span class="number">07</span> | <span class="number">1250</span> |  <span class="number">500</span> |     <span class="number">30</span> |     <span class="number">40</span> | OPERATIONS | BOSTON   |</span><br><span class="line">|  <span class="number">7596</span> | WARD   | SALESMAN | <span class="number">7902</span> | <span class="number">1993</span>-<span class="number">02</span>-<span class="number">07</span> | <span class="number">1250</span> |  <span class="number">500</span> |     <span class="number">30</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7596</span> | WARD   | SALESMAN | <span class="number">7902</span> | <span class="number">1993</span>-<span class="number">02</span>-<span class="number">07</span> | <span class="number">1250</span> |  <span class="number">500</span> |     <span class="number">30</span> |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7596</span> | WARD   | SALESMAN | <span class="number">7902</span> | <span class="number">1993</span>-<span class="number">02</span>-<span class="number">07</span> | <span class="number">1250</span> |  <span class="number">500</span> |     <span class="number">30</span> |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  <span class="number">7696</span> | JOOES  | MANAGER  | <span class="number">7839</span> | <span class="number">1980</span>-<span class="number">02</span>-<span class="number">01</span> | <span class="number">2975</span> |  <span class="number">100</span> |     <span class="number">20</span> |     <span class="number">40</span> | OPERATIONS | BOSTON   |</span><br><span class="line">|  <span class="number">7696</span> | JOOES  | MANAGER  | <span class="number">7839</span> | <span class="number">1980</span>-<span class="number">02</span>-<span class="number">01</span> | <span class="number">2975</span> |  <span class="number">100</span> |     <span class="number">20</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7696</span> | JOOES  | MANAGER  | <span class="number">7839</span> | <span class="number">1980</span>-<span class="number">02</span>-<span class="number">01</span> | <span class="number">2975</span> |  <span class="number">100</span> |     <span class="number">20</span> |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7696</span> | JOOES  | MANAGER  | <span class="number">7839</span> | <span class="number">1980</span>-<span class="number">02</span>-<span class="number">01</span> | <span class="number">2975</span> |  <span class="number">100</span> |     <span class="number">20</span> |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  <span class="number">7796</span> | MARTIN | SALESMAN | <span class="number">7698</span> | <span class="number">1999</span>-<span class="number">04</span>-<span class="number">17</span> | <span class="number">1250</span> | <span class="number">1400</span> |     <span class="number">30</span> |     <span class="number">40</span> | OPERATIONS | BOSTON   |</span><br><span class="line">|  <span class="number">7796</span> | MARTIN | SALESMAN | <span class="number">7698</span> | <span class="number">1999</span>-<span class="number">04</span>-<span class="number">17</span> | <span class="number">1250</span> | <span class="number">1400</span> |     <span class="number">30</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7796</span> | MARTIN | SALESMAN | <span class="number">7698</span> | <span class="number">1999</span>-<span class="number">04</span>-<span class="number">17</span> | <span class="number">1250</span> | <span class="number">1400</span> |     <span class="number">30</span> |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7796</span> | MARTIN | SALESMAN | <span class="number">7698</span> | <span class="number">1999</span>-<span class="number">04</span>-<span class="number">17</span> | <span class="number">1250</span> | <span class="number">1400</span> |     <span class="number">30</span> |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  <span class="number">7896</span> | BLAKE  | MANAGER  | <span class="number">7839</span> | <span class="number">1990</span>-<span class="number">12</span>-<span class="number">17</span> | <span class="number">2850</span> | NULL |     <span class="number">30</span> |     <span class="number">40</span> | OPERATIONS | BOSTON   |</span><br><span class="line">|  <span class="number">7896</span> | BLAKE  | MANAGER  | <span class="number">7839</span> | <span class="number">1990</span>-<span class="number">12</span>-<span class="number">17</span> | <span class="number">2850</span> | NULL |     <span class="number">30</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7896</span> | BLAKE  | MANAGER  | <span class="number">7839</span> | <span class="number">1990</span>-<span class="number">12</span>-<span class="number">17</span> | <span class="number">2850</span> | NULL |     <span class="number">30</span> |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7896</span> | BLAKE  | MANAGER  | <span class="number">7839</span> | <span class="number">1990</span>-<span class="number">12</span>-<span class="number">17</span> | <span class="number">2850</span> | NULL |     <span class="number">30</span> |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">+-------+--------+----------+------+------------+------+------+--------+--------+------------+----------+</span><br></pre></td></tr></table></figure>

<p>当不加限制的情况下，两张表的查询规则：</p>
<p>把第一张表的每一条记录和第二张表的每一条记录组合，返回结果是两张表的所有列，一共返回的记录数是第一张表的行数和第二张表的行数的乘积，而组成的表称为笛卡尔集</p>
<p>我们需要使用where对于笛卡尔集进行过滤，需要进行分析</p>
<p>当两张表的deptno编号相等的时候才是我们需要的结果</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp, dept <span class="keyword">where</span> emp.deptno<span class="operator">=</span>dept.deptno;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------+--------+----------+------+------------+------+------+--------+--------+----------+---------+</span></span><br><span class="line"><span class="operator">|</span> empno <span class="operator">|</span> ename  <span class="operator">|</span> job      <span class="operator">|</span> mgr  <span class="operator">|</span> hiredate   <span class="operator">|</span> sal  <span class="operator">|</span> comm <span class="operator">|</span> deptno <span class="operator">|</span> deptno <span class="operator">|</span> dname    <span class="operator">|</span> loc     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+----------+------+------------+------+------+--------+--------+----------+---------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7396</span> <span class="operator">|</span> SMITH  <span class="operator">|</span> CLERK    <span class="operator">|</span> <span class="number">7902</span> <span class="operator">|</span> <span class="number">1990</span><span class="number">-12</span><span class="number">-17</span> <span class="operator">|</span>  <span class="number">800</span> <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span> RESEARCH <span class="operator">|</span> DALLAS  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7499</span> <span class="operator">|</span> ALLEN  <span class="operator">|</span> SALESMAN <span class="operator">|</span> <span class="number">7902</span> <span class="operator">|</span> <span class="number">1991</span><span class="number">-02</span><span class="number">-20</span> <span class="operator">|</span> <span class="number">1600</span> <span class="operator">|</span>  <span class="number">300</span> <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span> SALES    <span class="operator">|</span> CHICAGO <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7596</span> <span class="operator">|</span> WARD   <span class="operator">|</span> SALESMAN <span class="operator">|</span> <span class="number">7902</span> <span class="operator">|</span> <span class="number">1993</span><span class="number">-02</span><span class="number">-07</span> <span class="operator">|</span> <span class="number">1250</span> <span class="operator">|</span>  <span class="number">500</span> <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span> SALES    <span class="operator">|</span> CHICAGO <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7696</span> <span class="operator">|</span> JOOES  <span class="operator">|</span> MANAGER  <span class="operator">|</span> <span class="number">7839</span> <span class="operator">|</span> <span class="number">1980</span><span class="number">-02</span><span class="number">-01</span> <span class="operator">|</span> <span class="number">2975</span> <span class="operator">|</span>  <span class="number">100</span> <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span> RESEARCH <span class="operator">|</span> DALLAS  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7796</span> <span class="operator">|</span> MARTIN <span class="operator">|</span> SALESMAN <span class="operator">|</span> <span class="number">7698</span> <span class="operator">|</span> <span class="number">1999</span><span class="number">-04</span><span class="number">-17</span> <span class="operator">|</span> <span class="number">1250</span> <span class="operator">|</span> <span class="number">1400</span> <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span> SALES    <span class="operator">|</span> CHICAGO <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7896</span> <span class="operator">|</span> BLAKE  <span class="operator">|</span> MANAGER  <span class="operator">|</span> <span class="number">7839</span> <span class="operator">|</span> <span class="number">1990</span><span class="number">-12</span><span class="number">-17</span> <span class="operator">|</span> <span class="number">2850</span> <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span> SALES    <span class="operator">|</span> CHICAGO <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+----------+------+------------+------+------+--------+--------+----------+---------+</span></span><br></pre></td></tr></table></figure>

<h4 id="笛卡尔例题"><a href="#笛卡尔例题" class="headerlink" title="笛卡尔例题"></a>笛卡尔例题</h4><p>显示雇员名，雇员工资，所在部门的名字</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,sal,dname <span class="keyword">from</span> emp, dept <span class="keyword">where</span> emp.deptno<span class="operator">=</span>dept.deptno;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">--------+------+----------+</span></span><br><span class="line"><span class="operator">|</span> ename  <span class="operator">|</span> sal  <span class="operator">|</span> dname    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------+----------+</span></span><br><span class="line"><span class="operator">|</span> SMITH  <span class="operator">|</span>  <span class="number">800</span> <span class="operator">|</span> RESEARCH <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN  <span class="operator">|</span> <span class="number">1600</span> <span class="operator">|</span> SALES    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD   <span class="operator">|</span> <span class="number">1250</span> <span class="operator">|</span> SALES    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JOOES  <span class="operator">|</span> <span class="number">2975</span> <span class="operator">|</span> RESEARCH <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN <span class="operator">|</span> <span class="number">1250</span> <span class="operator">|</span> SALES    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE  <span class="operator">|</span> <span class="number">2850</span> <span class="operator">|</span> SALES    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------+----------+</span></span><br></pre></td></tr></table></figure>

<p>而在选取重复列的时候，需要指定是哪一个表的列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,sal,dname,emp.deptno <span class="keyword">from</span> emp, dept <span class="keyword">where</span> emp.deptno<span class="operator">=</span>dept.deptno;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">--------+------+----------+--------+</span></span><br><span class="line"><span class="operator">|</span> ename  <span class="operator">|</span> sal  <span class="operator">|</span> dname    <span class="operator">|</span> deptno <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------+----------+--------+</span></span><br><span class="line"><span class="operator">|</span> SMITH  <span class="operator">|</span>  <span class="number">800</span> <span class="operator">|</span> RESEARCH <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN  <span class="operator">|</span> <span class="number">1600</span> <span class="operator">|</span> SALES    <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD   <span class="operator">|</span> <span class="number">1250</span> <span class="operator">|</span> SALES    <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JOOES  <span class="operator">|</span> <span class="number">2975</span> <span class="operator">|</span> RESEARCH <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN <span class="operator">|</span> <span class="number">1250</span> <span class="operator">|</span> SALES    <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE  <span class="operator">|</span> <span class="number">2850</span> <span class="operator">|</span> SALES    <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------+----------+--------+</span></span><br></pre></td></tr></table></figure>



<p>显示部门编号为20的部门名称，员工名，工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,sal,dname,emp.deptno </span><br><span class="line"><span class="keyword">from</span> emp,dept </span><br><span class="line"><span class="keyword">where</span> emp.deptno <span class="operator">=</span> dept.deptno </span><br><span class="line"><span class="keyword">and</span> emp.deptno <span class="operator">=</span> <span class="number">20</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------+------+----------+--------+</span></span><br><span class="line"><span class="operator">|</span> ename <span class="operator">|</span> sal  <span class="operator">|</span> dname    <span class="operator">|</span> deptno <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+----------+--------+</span></span><br><span class="line"><span class="operator">|</span> SMITH <span class="operator">|</span>  <span class="number">800</span> <span class="operator">|</span> RESEARCH <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JOOES <span class="operator">|</span> <span class="number">2975</span> <span class="operator">|</span> RESEARCH <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+----------+--------+</span></span><br></pre></td></tr></table></figure>



<p>显示各个员工的姓名，工资，以及工资级别</p>
<p>我们先选好需要的表格是emp表和salgrade表，我们这一道题的要点在于过滤条件该如何筛选</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,sal,grade <span class="keyword">from</span> emp, salgrade;</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">+--------+------+-------+</span><br><span class="line">| ename  | sal  | grade |</span><br><span class="line">+--------+------+-------+</span><br><span class="line">| SMITH  |  <span class="number">800</span> |     <span class="number">4</span> |</span><br><span class="line">| SMITH  |  <span class="number">800</span> |     <span class="number">3</span> |</span><br><span class="line">| SMITH  |  <span class="number">800</span> |     <span class="number">2</span> |</span><br><span class="line">| SMITH  |  <span class="number">800</span> |     <span class="number">1</span> |</span><br><span class="line">| ALLEN  | <span class="number">1600</span> |     <span class="number">4</span> |</span><br><span class="line">| ALLEN  | <span class="number">1600</span> |     <span class="number">3</span> |</span><br><span class="line">| ALLEN  | <span class="number">1600</span> |     <span class="number">2</span> |</span><br><span class="line">| ALLEN  | <span class="number">1600</span> |     <span class="number">1</span> |</span><br><span class="line">| WARD   | <span class="number">1250</span> |     <span class="number">4</span> |</span><br><span class="line">| WARD   | <span class="number">1250</span> |     <span class="number">3</span> |</span><br><span class="line">| WARD   | <span class="number">1250</span> |     <span class="number">2</span> |</span><br><span class="line">| WARD   | <span class="number">1250</span> |     <span class="number">1</span> |</span><br><span class="line">| JOOES  | <span class="number">2975</span> |     <span class="number">4</span> |</span><br><span class="line">| JOOES  | <span class="number">2975</span> |     <span class="number">3</span> |</span><br><span class="line">| JOOES  | <span class="number">2975</span> |     <span class="number">2</span> |</span><br><span class="line">| JOOES  | <span class="number">2975</span> |     <span class="number">1</span> |</span><br><span class="line">| MARTIN | <span class="number">1250</span> |     <span class="number">4</span> |</span><br><span class="line">| MARTIN | <span class="number">1250</span> |     <span class="number">3</span> |</span><br><span class="line">| MARTIN | <span class="number">1250</span> |     <span class="number">2</span> |</span><br><span class="line">| MARTIN | <span class="number">1250</span> |     <span class="number">1</span> |</span><br><span class="line">| BLAKE  | <span class="number">2850</span> |     <span class="number">4</span> |</span><br><span class="line">| BLAKE  | <span class="number">2850</span> |     <span class="number">3</span> |</span><br><span class="line">| BLAKE  | <span class="number">2850</span> |     <span class="number">2</span> |</span><br><span class="line">| BLAKE  | <span class="number">2850</span> |     <span class="number">1</span> |</span><br><span class="line">+--------+------+-------+</span><br></pre></td></tr></table></figure>



<p>运用between and语句即可完成，判断sal位于最高工资和最低工资之间即可</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,sal,grade <span class="keyword">from</span> emp, salgrade </span><br><span class="line"><span class="keyword">where</span> sal <span class="keyword">between</span> losal <span class="keyword">and</span> hisal;</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+--------+------+-------+</span><br><span class="line">| ename  | sal  | grade |</span><br><span class="line">+--------+------+-------+</span><br><span class="line">| SMITH  |  <span class="number">800</span> |     <span class="number">1</span> |</span><br><span class="line">| ALLEN  | <span class="number">1600</span> |     <span class="number">3</span> |</span><br><span class="line">| WARD   | <span class="number">1250</span> |     <span class="number">2</span> |</span><br><span class="line">| JOOES  | <span class="number">2975</span> |     <span class="number">3</span> |</span><br><span class="line">| MARTIN | <span class="number">1250</span> |     <span class="number">2</span> |</span><br><span class="line">| BLAKE  | <span class="number">2850</span> |     <span class="number">3</span> |</span><br><span class="line">+--------+------+-------+</span><br></pre></td></tr></table></figure>



<h4 id="自连接"><a href="#自连接" class="headerlink" title="自连接"></a>自连接</h4><p>是指的是同一张表的连接查询</p>
<p>显示公司员工和它上级的名字</p>
<p>这个时候我们就需要使用到表的自连接，将员工和上级放在同一行中筛选完成（还需要有一个别名）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp empee, emp boss;</span><br></pre></td></tr></table></figure>

<p>这样就可以将同一张表连接起来，我们再去写过滤条件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> empee.ename,boss.ename  </span><br><span class="line"><span class="keyword">from</span> emp empee, emp boss </span><br><span class="line"><span class="keyword">where</span> empee.mgr <span class="operator">=</span> boss.empno;</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+-------+-------+</span><br><span class="line">| ename | ename |</span><br><span class="line">+-------+-------+</span><br><span class="line">| WARD  | BLAKE |</span><br><span class="line">+-------+-------+</span><br></pre></td></tr></table></figure>



<h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><p>子查询是指嵌入在其他sql语句中的select语句，也成为嵌套查询</p>
<p>单行子查询：只返回一行数据的子查询语句</p>
<p>多行子查询：返回多行数据的子查询语句（in）</p>
<p>单行子查询例题</p>
<p>如何显示于SMITH同一部门的所有员工</p>
<p>我们首先需要得到SMITH的部门号，再通过部门号筛选</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="operator">=</span> <span class="string">&#x27;SMITH&#x27;</span>;<span class="operator">/</span><span class="operator">/</span><span class="number">20</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">20</span>;</span><br></pre></td></tr></table></figure>

<p>我们可以把第一个查询嵌入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> deptno <span class="operator">=</span> (</span><br><span class="line">	<span class="keyword">select</span> deptno </span><br><span class="line">    <span class="keyword">from</span> emp </span><br><span class="line">    <span class="keyword">where</span> ename <span class="operator">=</span> <span class="string">&#x27;SMITH&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>即可完成</p>
<p>多行子查询例题</p>
<p>查询和部门20的工作相同的雇员的名字、岗位、部门号，但是不包含20自己的</p>
<p>第一步：查询20号部门有哪一些工作岗位（还需要去重）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> job <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">20</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+---------+</span><br><span class="line">| job     |</span><br><span class="line">+---------+</span><br><span class="line">| CLERK   |</span><br><span class="line">| MANAGER |</span><br><span class="line">+---------+</span><br></pre></td></tr></table></figure>

<p>第二步：运用job的工作字段进行查询筛选</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,job,sal,deptno <span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> job <span class="keyword">in</span>(<span class="string">&#x27;CLERK&#x27;</span>,<span class="string">&#x27;MANAGER&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>第三步：不包含20号部门</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,job,sal,deptno <span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> job <span class="keyword">in</span>(<span class="string">&#x27;CLERK&#x27;</span>,<span class="string">&#x27;MANAGER&#x27;</span>) <span class="keyword">and</span> deptno<span class="operator">&lt;&gt;</span><span class="number">20</span>;</span><br></pre></td></tr></table></figure>

<p>综合嵌套一下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,job,sal,deptno <span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> job <span class="keyword">in</span>(</span><br><span class="line">	<span class="keyword">select</span> <span class="keyword">distinct</span> job </span><br><span class="line">	<span class="keyword">from</span> emp </span><br><span class="line">	<span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">20</span>) </span><br><span class="line"><span class="keyword">and</span> deptno<span class="operator">&lt;&gt;</span><span class="number">20</span>;</span><br></pre></td></tr></table></figure>



<h4 id="子查询临时表"><a href="#子查询临时表" class="headerlink" title="子查询临时表"></a>子查询临时表</h4><p>查询ecshop中各个类别中，价格最高的商品</p>
<p>先得到各个类别中价格最高的商品</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> cat_id, <span class="built_in">max</span>(shop_price) <span class="keyword">from</span> ecsshop</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> cat_id;</span><br></pre></td></tr></table></figure>

<p>我们可以将这个表格和ecsshop表进行连接，在设置过滤条件即可完成要求</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ecshop.cat_id, ecshop.goods_name </span><br><span class="line"><span class="keyword">from</span> ecshop,(</span><br><span class="line"><span class="keyword">select</span> cat_id, <span class="built_in">max</span>(shop_price) <span class="keyword">as</span> max_price</span><br><span class="line"><span class="keyword">from</span> ecshop</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> cat_id)temp</span><br><span class="line"><span class="keyword">where</span> ecshop.cat_id<span class="operator">=</span>temp.cat_id </span><br><span class="line"><span class="keyword">and</span> ecshop.shop_price<span class="operator">=</span>temp.max_price;</span><br></pre></td></tr></table></figure>



<h4 id="all和any操作符"><a href="#all和any操作符" class="headerlink" title="all和any操作符"></a>all和any操作符</h4><p>all</p>
<p>所有的字段都满足</p>
<p>显示比部门30的所有员工的工资高的员工姓名、工资、部门号</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,sal,deptno <span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> sal<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">all</span>(</span><br><span class="line">    <span class="keyword">select</span> sal </span><br><span class="line">    <span class="keyword">from</span> emp </span><br><span class="line">    <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">30</span>);</span><br></pre></td></tr></table></figure>

<p>也可以运用max查询最大的薪水，再通过判断条件筛选</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,sal,deptno <span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> sal<span class="operator">&gt;</span></span><br><span class="line">(<span class="keyword">select</span> <span class="built_in">max</span>(sal) </span><br><span class="line"> <span class="keyword">from</span> emp </span><br><span class="line"> <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">30</span>);</span><br></pre></td></tr></table></figure>



<p>any</p>
<p>有一个字段满足条件即可</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,sal,deptno <span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> sal<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">any</span>(</span><br><span class="line">    <span class="keyword">select</span> sal </span><br><span class="line">    <span class="keyword">from</span> emp </span><br><span class="line">    <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">30</span>);</span><br></pre></td></tr></table></figure>

<p>也可以改为</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,sal,deptno <span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> sal<span class="operator">&gt;</span></span><br><span class="line">(<span class="keyword">select</span> <span class="built_in">min</span>(sal) </span><br><span class="line"> <span class="keyword">from</span> emp </span><br><span class="line"> <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">30</span>);</span><br></pre></td></tr></table></figure>



<h4 id="多列子查询"><a href="#多列子查询" class="headerlink" title="多列子查询"></a>多列子查询</h4><p>多列子查询指的是查询返回多个列数据的子查询语句</p>
<p>例如查询于SMITH部门，岗位完全相同的所有雇员</p>
<p>第一步：查询SMITH所在的部门以及岗位</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,job <span class="keyword">from</span> emp <span class="keyword">where</span> ename<span class="operator">=</span><span class="string">&#x27;SMITH&#x27;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+--------+-------+</span><br><span class="line">| deptno | job   |</span><br><span class="line">+--------+-------+</span><br><span class="line">|     <span class="number">20</span> | CLERK |</span><br><span class="line">+--------+-------+</span><br></pre></td></tr></table></figure>

<p>第二步：将上述的查询结果当作查询使用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename, deptno, job <span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> deptno<span class="operator">=</span><span class="number">20</span> </span><br><span class="line"><span class="keyword">and</span> job<span class="operator">=</span><span class="string">&#x27;CLERK&#x27;</span></span><br><span class="line"><span class="keyword">and</span> ename<span class="operator">&lt;&gt;</span><span class="string">&#x27;SMITH&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>综合嵌套(运用（）来进行相应的字段匹配)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename, deptno, job <span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> (deptno, job) <span class="operator">=</span> (</span><br><span class="line">	<span class="keyword">select</span> deptno,job <span class="keyword">from</span> emp </span><br><span class="line">    <span class="keyword">where</span> ename<span class="operator">=</span><span class="string">&#x27;SMITH&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">and</span> ename<span class="operator">&lt;&gt;</span><span class="string">&#x27;SMITH&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h4 id="相关例题"><a href="#相关例题" class="headerlink" title="相关例题"></a>相关例题</h4><p>例题一：</p>
<p>查找每个部门工资高于本部门平均工资人的资料</p>
<p>第一步：查询部门的平均工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno, <span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br></pre></td></tr></table></figure>

<p>第二步：将查询的结果表和员工表进行拼接，再进行筛选</p>
<p>(这里的emp.*代表选出emp表的所有字段)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> emp.<span class="operator">*</span> <span class="keyword">from</span> emp,(</span><br><span class="line">	<span class="keyword">select</span> deptno, <span class="built_in">avg</span>(sal)<span class="keyword">as</span> avg_sal</span><br><span class="line">	<span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno</span><br><span class="line">)temp <span class="keyword">where</span> emp.deptno<span class="operator">=</span>temp.deptno </span><br><span class="line"><span class="keyword">and</span> emp.sal<span class="operator">&gt;</span>temp.avg_sal;</span><br></pre></td></tr></table></figure>



<p>例题二：</p>
<p>查询每个部门工资最高的人的详细资料</p>
<p>第一步：查询部门的最高工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno, <span class="built_in">max</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br></pre></td></tr></table></figure>

<p>第二步：将查询的结果表和员工表进行拼接，再进行筛选</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> emp.<span class="operator">*</span> <span class="keyword">from</span> emp,(</span><br><span class="line">	<span class="keyword">select</span> deptno, <span class="built_in">max</span>(sal)<span class="keyword">as</span> avg_sal</span><br><span class="line">	<span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno</span><br><span class="line">)temp <span class="keyword">where</span> emp.deptno<span class="operator">=</span>temp.deptno </span><br><span class="line"><span class="keyword">and</span> emp.sal<span class="operator">=</span>temp.avg_sal;</span><br></pre></td></tr></table></figure>



<p>例题三：</p>
<p>查询每个部门的信息（包括：部门名，编号，地址）和人员数量</p>
<p>思路：我们的信息来自于dept表，而人员数量需要构建临时表格</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>),deptno <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+----------+--------+</span><br><span class="line">| count(*) | deptno |</span><br><span class="line">+----------+--------+</span><br><span class="line">|        <span class="number">2</span> |     <span class="number">20</span> |</span><br><span class="line">|        <span class="number">4</span> |     <span class="number">30</span> |</span><br><span class="line">+----------+--------+</span><br></pre></td></tr></table></figure>

<p>和部门信息表格拼接</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dept.<span class="operator">*</span>, countp </span><br><span class="line"><span class="keyword">from</span> dept,(</span><br><span class="line">	<span class="keyword">select</span> deptno,<span class="built_in">count</span>(<span class="operator">*</span>)<span class="keyword">as</span> countp </span><br><span class="line">	<span class="keyword">from</span> emp </span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> deptno)temp </span><br><span class="line"><span class="keyword">where</span> dept.deptno<span class="operator">=</span>temp.deptno;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">--------+----------+---------+--------+</span></span><br><span class="line"><span class="operator">|</span> deptno <span class="operator">|</span> dname    <span class="operator">|</span> loc     <span class="operator">|</span> countp <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+---------+--------+</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span> RESEARCH <span class="operator">|</span> DALLAS  <span class="operator">|</span>      <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span> SALES    <span class="operator">|</span> CHICAGO <span class="operator">|</span>      <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+---------+--------+</span></span><br></pre></td></tr></table></figure>



<h3 id="表复制"><a href="#表复制" class="headerlink" title="表复制"></a>表复制</h3><h4 id="自我复制数据"><a href="#自我复制数据" class="headerlink" title="自我复制数据"></a>自我复制数据</h4><p>有的时候，为了对于某个sql语句进行效率测试，我们需要海量的数据，可以使用此法为表创建海量的数据</p>
<p>例如创建这一张表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> my_table(	</span><br><span class="line">	id <span class="type">int</span>,</span><br><span class="line">    `name` <span class="type">varchar</span>(<span class="number">32</span>),</span><br><span class="line">	sal <span class="keyword">double</span>,</span><br><span class="line">	job <span class="type">varchar</span>(<span class="number">32</span>),</span><br><span class="line">	deptno <span class="type">int</span></span><br><span class="line">	);</span><br></pre></td></tr></table></figure>

<p>我们先将emp表中的内容复制到创建的新表中</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> my_table(id,`name`,sal,job,deptno)</span><br><span class="line"><span class="keyword">select</span> empno,ename,sal,job,deptno <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p>自我复制：每一次都会将表中的内容复制添加到自己的表中</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> my_table</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> my_table;</span><br></pre></td></tr></table></figure>



<h4 id="去除表中的重复数据"><a href="#去除表中的重复数据" class="headerlink" title="去除表中的重复数据"></a>去除表中的重复数据</h4><p>可以通过like创建一个新表，格式和旧表一样</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> table2 <span class="keyword">like</span> table1</span><br></pre></td></tr></table></figure>



<p>思路：</p>
<p>1.创建一张临时表mytemp,该表数据结构和my_table一样</p>
<p>2.把my_temp的记录通过distinct关键字处理复制</p>
<p>3.清除掉原先表my_table的记录</p>
<p>4.将my_temp的记录复制到my_table</p>
<p>5.drop删除临时表my_temp</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> my_temp <span class="keyword">like</span> my_table;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> my_temp</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> <span class="operator">*</span> <span class="keyword">from</span> my_table;</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> my_table;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> my_table</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> my_temp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> my_temp;</span><br></pre></td></tr></table></figure>

<p>或者你直接删除原先的my_table表，再将my_temp表格更改名称为my_table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rename <span class="keyword">table</span> my_temp <span class="keyword">to</span> my_table;</span><br></pre></td></tr></table></figure>



<h3 id="合并查询"><a href="#合并查询" class="headerlink" title="合并查询"></a>合并查询</h3><h4 id="union"><a href="#union" class="headerlink" title="union"></a>union</h4><p>在实际使用的时候，有的时候我们需要合并多个select语句查询到的结果，我们会用到union操作</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select... <span class="keyword">union</span> select...;</span><br></pre></td></tr></table></figure>

<p>例如我们查询职业名称为clerk和部门号为20的并集</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> job<span class="operator">=</span><span class="string">&#x27;clerk&#x27;</span> </span><br><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno<span class="operator">=</span><span class="number">20</span>;</span><br></pre></td></tr></table></figure>

<h4 id="union-all"><a href="#union-all" class="headerlink" title="union all"></a>union all</h4><p>如果你添加了all，则不会去除重复内容</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> job<span class="operator">=</span><span class="string">&#x27;clerk&#x27;</span> </span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno<span class="operator">=</span><span class="number">20</span>;</span><br></pre></td></tr></table></figure>



<h3 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h3><h4 id="问题引出"><a href="#问题引出" class="headerlink" title="问题引出"></a>问题引出</h4><p>还记得之前我们的多表查询嘛，我们在合并表的时候会求多表的笛卡尔集</p>
<p>我们有一个要求如下：列出部门名称和这些部门的员工名称和工作，同时要求显示出那些没有员工的部门名</p>
<p>我们如果用笛卡尔积的话查询结果如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dname,ename,job </span><br><span class="line"><span class="keyword">from</span> emp,dept </span><br><span class="line"><span class="keyword">where</span> emp.deptno<span class="operator">=</span>dept.deptno;</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+----------+--------+----------+</span><br><span class="line">| dname    | ename  | job      |</span><br><span class="line">+----------+--------+----------+</span><br><span class="line">| RESEARCH | SMITH  | CLERK    |</span><br><span class="line">| RESEARCH | JOOES  | MANAGER  |</span><br><span class="line">| SALES    | ALLEN  | SALESMAN |</span><br><span class="line">| SALES    | WARD   | SALESMAN |</span><br><span class="line">| SALES    | MARTIN | SALESMAN |</span><br><span class="line">| SALES    | BLAKE  | MANAGER  |</span><br><span class="line">+----------+--------+----------+</span><br></pre></td></tr></table></figure>



<p>但是事实上我们的部门中还有其他的部门没有显示出来</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+--------+------------+----------+</span><br><span class="line">| deptno | dname      | loc      |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">|     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|     <span class="number">40</span> | OPERATIONS | BOSTON   |</span><br><span class="line">+--------+------------+----------+</span><br></pre></td></tr></table></figure>

<p>这是因为员工表的部门号没有10、40无法匹配到部门表，我们要实现显示出那些没有员工的部门，我们需要外连接，我们创建如下的表作演示</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> stu (</span><br><span class="line">`id` <span class="type">INT</span>,</span><br><span class="line">`name` <span class="type">VARCHAR</span> ( <span class="number">32</span> ));</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> stu</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">	( <span class="number">1</span>, <span class="string">&#x27;Jack&#x27;</span> ),</span><br><span class="line">	( <span class="number">2</span>, <span class="string">&#x27;Tom&#x27;</span> ),</span><br><span class="line">	( <span class="number">3</span>, <span class="string">&#x27;Kity&#x27;</span> ),</span><br><span class="line">	( <span class="number">4</span>, <span class="string">&#x27;nono&#x27;</span> );</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> exam (</span><br><span class="line">`id` <span class="type">INT</span>,</span><br><span class="line">`grade` <span class="type">INT</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> exam</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">	( <span class="number">1</span>, <span class="number">56</span> ),</span><br><span class="line">	( <span class="number">2</span>, <span class="number">76</span> ),</span><br><span class="line">	( <span class="number">11</span>, <span class="number">8</span> );</span><br></pre></td></tr></table></figure>

<p>用where条件筛选后</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stu,exam <span class="keyword">where</span> stu.id<span class="operator">=</span>exam.id;</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+----+------+----+-------+</span><br><span class="line">| id | name | id | grade |</span><br><span class="line">+----+------+----+-------+</span><br><span class="line">|  <span class="number">1</span> | Jack |  <span class="number">1</span> |    <span class="number">56</span> |</span><br><span class="line">|  <span class="number">2</span> | Tom  |  <span class="number">2</span> |    <span class="number">76</span> |</span><br><span class="line">+----+------+----+-------+</span><br></pre></td></tr></table></figure>

<p>可见是没有11号id和4号id的行记录的，因为id不是左右两表都有</p>
<h4 id="左外连接"><a href="#左外连接" class="headerlink" title="左外连接"></a>左外连接</h4><p>左侧的表完全显示（如果没有成绩也要显示姓名与id）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stu <span class="keyword">left</span> <span class="keyword">join</span> exam <span class="keyword">on</span> stu.id<span class="operator">=</span>exam.id;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----+------+------+-------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name <span class="operator">|</span> id   <span class="operator">|</span> grade <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+------+-------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Jack <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span>    <span class="number">56</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> Tom  <span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span>    <span class="number">76</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Kity <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> nono <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+------+-------+</span></span><br></pre></td></tr></table></figure>



<h4 id="右外连接"><a href="#右外连接" class="headerlink" title="右外连接"></a>右外连接</h4><p>又侧的表完全显示（如果没有姓名也要显示成绩与id）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stu <span class="keyword">right</span> <span class="keyword">join</span> exam <span class="keyword">on</span> stu.id<span class="operator">=</span>exam.id;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">------+------+----+-------+</span></span><br><span class="line"><span class="operator">|</span> id   <span class="operator">|</span> name <span class="operator">|</span> id <span class="operator">|</span> grade <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+----+-------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Jack <span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span>    <span class="number">56</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> Tom  <span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span>    <span class="number">76</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="number">11</span> <span class="operator">|</span>     <span class="number">8</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+----+-------+</span></span><br></pre></td></tr></table></figure>



<h4 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h4><p>回到我们的例题：列出部门名称和这些部门的员工名称和工作，同时要求显示出那些没有员工的部门名</p>
<p>左外连接实现：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dept.deptno,dname,ename,job </span><br><span class="line"><span class="keyword">from</span> dept <span class="keyword">left</span> <span class="keyword">join</span> emp </span><br><span class="line"><span class="keyword">on</span> dept.deptno<span class="operator">=</span>emp.deptno; </span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">--------+------------+--------+----------+</span></span><br><span class="line"><span class="operator">|</span> deptno <span class="operator">|</span> dname      <span class="operator">|</span> ename  <span class="operator">|</span> job      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+--------+----------+</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">10</span> <span class="operator">|</span> ACCOUNTING <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span> <span class="keyword">NULL</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span> RESEARCH   <span class="operator">|</span> JOOES  <span class="operator">|</span> MANAGER  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span> RESEARCH   <span class="operator">|</span> SMITH  <span class="operator">|</span> CLERK    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span> SALES      <span class="operator">|</span> BLAKE  <span class="operator">|</span> MANAGER  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span> SALES      <span class="operator">|</span> MARTIN <span class="operator">|</span> SALESMAN <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span> SALES      <span class="operator">|</span> WARD   <span class="operator">|</span> SALESMAN <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span> SALES      <span class="operator">|</span> ALLEN  <span class="operator">|</span> SALESMAN <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">40</span> <span class="operator">|</span> OPERATIONS <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span> <span class="keyword">NULL</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+--------+----------+</span></span><br></pre></td></tr></table></figure>

<p>右外连接实现：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dept.deptno,dname,ename,job </span><br><span class="line"><span class="keyword">from</span> emp <span class="keyword">right</span> <span class="keyword">join</span> dept </span><br><span class="line"><span class="keyword">on</span> dept.deptno<span class="operator">=</span>emp.deptno; </span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">--------+------------+--------+----------+</span></span><br><span class="line"><span class="operator">|</span> deptno <span class="operator">|</span> dname      <span class="operator">|</span> ename  <span class="operator">|</span> job      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+--------+----------+</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">10</span> <span class="operator">|</span> ACCOUNTING <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span> <span class="keyword">NULL</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span> RESEARCH   <span class="operator">|</span> JOOES  <span class="operator">|</span> MANAGER  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span> RESEARCH   <span class="operator">|</span> SMITH  <span class="operator">|</span> CLERK    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span> SALES      <span class="operator">|</span> BLAKE  <span class="operator">|</span> MANAGER  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span> SALES      <span class="operator">|</span> MARTIN <span class="operator">|</span> SALESMAN <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span> SALES      <span class="operator">|</span> WARD   <span class="operator">|</span> SALESMAN <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span> SALES      <span class="operator">|</span> ALLEN  <span class="operator">|</span> SALESMAN <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">40</span> <span class="operator">|</span> OPERATIONS <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span> <span class="keyword">NULL</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+--------+----------+</span></span><br></pre></td></tr></table></figure>



<h2 id="MySQL中的约束"><a href="#MySQL中的约束" class="headerlink" title="MySQL中的约束"></a>MySQL中的约束</h2><p>何为约束？</p>
<p>约束是用于确保数据库数据满足特定的商业规则，而再mysql中约束包括not null、unique、primary key、foreign key、check五种</p>
<h3 id="primary-key"><a href="#primary-key" class="headerlink" title="primary key"></a>primary key</h3><p>primary key：用于唯一的标示表行的数据，当定义主键约束之后，该列不可以重复，以下是一个案例</p>
<p>创建一个主键为id表，向其中插入数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> primary_test (</span><br><span class="line">	`id` <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">	`name` <span class="type">VARCHAR</span> ( <span class="number">32</span> ),</span><br><span class="line">	`email` <span class="type">VARCHAR</span> ( <span class="number">32</span> ) </span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> primary_test <span class="keyword">values</span></span><br><span class="line">(<span class="number">1</span>,<span class="string">&#x27;jack&#x27;</span>,<span class="string">&#x27;jack@qq.com&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>,<span class="string">&#x27;marry&#x27;</span>,<span class="string">&#x27;marry@gmail.com&#x27;</span>),</span><br><span class="line">(<span class="number">3</span>,<span class="string">&#x27;lory&#x27;</span>,<span class="string">&#x27;lory@163.com&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>我们现在加一条语句，id为1（之前加过id为1的记录）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> primary_test <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;jerry&#x27;</span>,<span class="string">&#x27;jerry@qq.com&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>报错</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="number">1062</span> - Duplicate entry &#x27;<span class="number">1</span>&#x27; <span class="keyword">for</span> key &#x27;primary_test.PRIMARY&#x27;</span><br></pre></td></tr></table></figure>



<p>主键的细节</p>
<p>1.一张表最多只能有一个主键，但可以是复合主键</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> primary_test2 (</span><br><span class="line">	`id` <span class="type">INT</span> ,</span><br><span class="line">	`name` <span class="type">VARCHAR</span> ( <span class="number">32</span> ),</span><br><span class="line">	`email` <span class="type">VARCHAR</span> ( <span class="number">32</span> ) ,</span><br><span class="line">	 <span class="keyword">primary</span> key(`id`,`name`)</span><br><span class="line">) ;</span><br></pre></td></tr></table></figure>

<p>2.主键的指定方式有两种，第一种是直接在字段名 类型后加上primary key，第二种是在表的定义最后加上primary key(列名)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> primary_test4 (</span><br><span class="line">	`id` <span class="type">INT</span> ,</span><br><span class="line">	`name` <span class="type">VARCHAR</span> ( <span class="number">32</span> ),</span><br><span class="line">	`email` <span class="type">VARCHAR</span> ( <span class="number">32</span> ) ,</span><br><span class="line">	 <span class="keyword">primary</span> key(`id`)</span><br><span class="line">) ;</span><br></pre></td></tr></table></figure>

<p>3.使用desc可以查看主键情况</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field <span class="operator">|</span> Type        <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> <span class="type">int</span>         <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">32</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> email <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">32</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br></pre></td></tr></table></figure>

<p>4.主键不可以重复且不能为空</p>
<h3 id="not-null"><a href="#not-null" class="headerlink" title="not null"></a>not null</h3><p>非空约束，当列上定义了not null，那么插入数据的时候必须要提供数据</p>
<h3 id="unique"><a href="#unique" class="headerlink" title="unique"></a>unique</h3><p>唯一约束</p>
<p>1.当定义了唯一约束的时候，该列的值不可以重复</p>
<p>2.一张表可以有多个unique字段</p>
<p>3.当unique没有添加非空约束，则unique字段可以有多个null</p>
<h3 id="foreign-key"><a href="#foreign-key" class="headerlink" title="foreign key"></a>foreign key</h3><p>外键</p>
<p>用于定义主表和从表之间的关系：外键约束要定义在从表上，主表则必须要拥有主键约束或者是unique约束，当定义外键约束后，要求外键列数据必须要在主表的主键列存在或者是null</p>
<p>举个栗子：</p>
<p>例如我们有一个学生表其中有id和class_id，还有一个班级表，有属性id，如果我们要求，每个学生所在的班级号class_id是存在于班级表的，就可以把class_id做成外键约束（班级表为主表，而学生表为从表）</p>
<p>当我们插入一个学生它的班级编号不存在于班级表，则插入失败</p>
<p>当我们学生表有一个学生他的班级编号存在班级表，则删除对应的班级表id会删除失败</p>
<p>班级表（主表）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> my_class (</span><br><span class="line">	`id` <span class="type">INT</span> <span class="keyword">primary</span> key,</span><br><span class="line">	`name` <span class="type">VARCHAR</span> ( <span class="number">32</span> ),</span><br><span class="line">	`<span class="keyword">add</span>` <span class="type">VARCHAR</span> ( <span class="number">32</span> ) </span><br><span class="line">) ;</span><br></pre></td></tr></table></figure>

<p>学生表（从表）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> my_stu (</span><br><span class="line">	`id` <span class="type">INT</span> <span class="keyword">primary</span> key,</span><br><span class="line">	`name` <span class="type">VARCHAR</span> (<span class="number">32</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	`class_id` <span class="type">int</span>,</span><br><span class="line">	<span class="keyword">foreign</span> key(class_id) <span class="keyword">references</span> my_class(id)</span><br><span class="line">) ;</span><br></pre></td></tr></table></figure>



<p>外键细节</p>
<p>1.外键指向的表字段，要求为primary key或者是unique</p>
<p>2.表的类型是innodb，这样的表才支持外键</p>
<p>3.外键字段的类型要求和主键字段类型一致</p>
<p>4.外键字段的值必须要求在主键字段中出现过，或者为null</p>
<p>5.一旦建立主外键的关系，数据就不可以随意删除了</p>
<h3 id="check"><a href="#check" class="headerlink" title="check"></a>check</h3><p>用于强制行数据必须满足条件，注意在mysql 5.7，这里插入不符合check的数据会成功（只是会提示）8.0是会生效的</p>
<p>假设sal列上定义了check约束，并要求sql列值在1000-2000之间，性别为两个，那么如果插入的记录如果不满足相关条件就会提示报错</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test (</span><br><span class="line">	`id` <span class="type">INT</span> <span class="keyword">primary</span> key,</span><br><span class="line">	`name` <span class="type">VARCHAR</span> (<span class="number">32</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	`sex` <span class="type">VARCHAR</span>(<span class="number">10</span>) <span class="keyword">CHECK</span> (`sex` <span class="keyword">IN</span>(<span class="string">&#x27;man&#x27;</span>,<span class="string">&#x27;woman&#x27;</span>)),</span><br><span class="line">	`sal` <span class="keyword">double</span> <span class="keyword">CHECK</span> (`sal`<span class="operator">&gt;</span><span class="number">1000</span> <span class="keyword">and</span> `sal`<span class="operator">&lt;</span><span class="number">2000</span>)</span><br><span class="line">) ;</span><br></pre></td></tr></table></figure>



<h3 id="表设计"><a href="#表设计" class="headerlink" title="表设计"></a>表设计</h3><p>现有一个商店的数据库shop_database，记录客户以及其购物情况，有以下的三个表组成</p>
<p>goods商品表：</p>
<p>商品号goods_id  商品名称goods_name  价格price  商品类别category 供货商provider</p>
<p>customer顾客表：</p>
<p>客户号customer_id  姓名name  住址address  邮箱email  性别sex  身份证id</p>
<p>purchase购买表：</p>
<p>订单号order_id  客户号customer_id  商品号goods_id  购买数量nums</p>
<p>要求如下：</p>
<p>1.合理定义主键、外键</p>
<p>2.客户姓名不可以为空值</p>
<p>3.电子邮箱不可以为重复</p>
<p>4.客户的性别约束‘男’|‘女’</p>
<p>5.价格在1.0——9999.99之间</p>
<p>goods</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> goods(</span><br><span class="line">goods_id <span class="type">int</span> <span class="keyword">primary</span> key,</span><br><span class="line">goods_name <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">default</span> <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">price <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>)<span class="keyword">not</span> <span class="keyword">null</span> </span><br><span class="line">    <span class="keyword">check</span>(price <span class="keyword">between</span> <span class="number">1.0</span> <span class="keyword">and</span> <span class="number">9999.99</span>),</span><br><span class="line">category <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">default</span> <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">provider <span class="type">varchar</span>(<span class="number">30</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>customer</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> customer(</span><br><span class="line">customer_id <span class="type">int</span> <span class="keyword">primary</span> key,</span><br><span class="line">name <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">address <span class="type">varchar</span>(<span class="number">30</span>),</span><br><span class="line">email <span class="type">varchar</span>(<span class="number">30</span>),</span><br><span class="line">sex <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">check</span>(sex <span class="keyword">IN</span>(<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;女&#x27;</span>)),</span><br><span class="line">id <span class="type">decimal</span>(<span class="number">20</span>,<span class="number">0</span>) <span class="keyword">unique</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>purchase</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> purchase(</span><br><span class="line">order_id <span class="type">int</span> <span class="keyword">primary</span> key,</span><br><span class="line">customer_id <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">goods_id <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">nums <span class="type">int</span>,</span><br><span class="line"><span class="keyword">FOREIGN</span> key(customer_id) <span class="keyword">REFERENCES</span> customer(customer_id),</span><br><span class="line"><span class="keyword">FOREIGN</span> key(goods_id) <span class="keyword">REFERENCES</span> goods(goods_id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>


        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2025/04/14/MySQL%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0%EF%BC%88%E7%B4%A2%E5%BC%95%EF%BC%8C%E4%BA%8B%E5%8A%A1%EF%BC%8C%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%EF%BC%8C%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%EF%BC%8C%E8%A7%86%E5%9B%BE%EF%BC%8C%E7%AE%A1%E7%90%86%EF%BC%89/"
      title="MySQL课堂笔记（索引，事务，隔离级别，存储引擎，视图，管理）"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        MySQL课堂笔记（索引，事务，隔离级别，存储引擎，视图，管理）
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2025/04/11/MySQL%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BF%AE%E6%94%B9%E8%A1%A8%EF%BC%8CCRUD%EF%BC%8C%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0%EF%BC%89/"
      title="MySQL课堂笔记（修改表，CRUD，常用函数）"
     >

    <p class="title-text">
      
        MySQL课堂笔记（修改表，CRUD，常用函数）
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>


  
  <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
  <div id="comment-card" class="comment-card">
    <div class="main-title-bar">
      <div class="main-title-dot"></div>
      <div class="main-title">Comments </div>
    </div>
    <div id="vcomments"></div>
  </div>
  <script>
      new Valine({"enable":true,"appId":null,"appKey":null,"placeholder":"Just go go","pageSize":10,"highlight":true,"serverURLs":null,"el":"#vcomments"});
  </script>




    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 Thrinisty<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>
